import pprint

pp = pprint.PrettyPrinter(width=190)

G = [[1.0, 0.1, 0.3, 0.1],
     [0.2, 1.0, 0.3, 0.1],
     [0.2, 0.2, 1.0, 0.1],
     [0.1, 0.1, 0.1, 1]]
r = [1.0, 1.5, 1.0, 1]


# G = [[1.0, 0.1, 0.2,0.3],
#      [0.2, 1.0, 0.1, 0.1],
#      [0.2, 0.1, 1.0, 0.1],
#      [0.1, 0.1, 0.3, 1.0]]
# r = [2.0, 2.5, 1.5, 2.0]

n = 0.1

pi = [[0.1890030484, 0.29585670300000005, 0.19723977030000003, 1]]
SIRi = []


# Gji = send from i to j

def get_p():
    return pi[len(pi) - 1]


def get_SIR():
    return SIRi[len(SIRi) - 1]


def calc_SIR(i):
    p = get_p()
    sum = 0.0
    # print(sum)
    for j in range(len(G)):
        if i == j: continue
        sum += (G[i][j] * p[j])

    return (G[i][i] * p[i]) / (sum + n)


def update_SIRi():
    SIR = []
    for i in range(len(G)):
        SIR.append(calc_SIR(i))
    SIRi.append(SIR)

def update_pi():
    p_next = []
    p_old = get_p()
    SIR = get_SIR()
    for i in range(len(G)):
        p_next.append((r[i]/SIR[i])*p_old[i])
    pi.append(p_next)

update_SIRi()



for k in range(10):
    update_pi()
    update_SIRi()

print("SIR")
pp.pprint(SIRi)
print("p")
pp.pprint(pi)


# result
# SIR
# [[0.654538780936644, 0.9962426230818958, 0.6641696972189882, 5.944951455603282],
#  [1.152916135302015, 1.6894936025677487, 1.1263260720840362, 0.8281356630856809],
#  [1.048115340457904, 1.5851367478917302, 1.0567587670172787, 1.0636616413096436],
#  [1.0327969994164408, 1.5481738533324998, 1.0321156143107266, 1.0251788065325889],
#  [1.0174251133349166, 1.5272661937069585, 1.018177550133848, 1.0147067238236054],
#  [1.0098227915864433, 1.5150419474495989, 1.0100279384536603, 1.0081012122087396],
#  [1.0053943368180276, 1.5083229785520835, 1.0055486603577621, 1.0044709126933584],
#  [1.0029766011739814, 1.504581522601491, 1.0030543459981434, 1.002461294547923],
#  [1.001636336079855, 1.502520851245469, 1.001680568218817, 1.0013534810122193],
#  [1.000899618601689, 1.5013855426719118, 1.0009236948978941, 1.0007438472933767],
#  [1.0004942527367575, 1.5007613039315364, 1.0005075360193985, 1.0004086640944585]]
# p
# [[0.1890030484, 0.29585670300000005, 0.19723977030000003, 1],
#  [0.28875760139000006, 0.445458811155, 0.29697195028000006, 0.16820995217],
#  [0.2504584614165, 0.3954961508685001, 0.26366427772600004, 0.20311883628250005],
#  [0.23896078203290003, 0.37425428884402506, 0.24950280608525008, 0.19096188900110003],
#  [0.23137245961008754, 0.36260878069839764, 0.24173920307549507, 0.1862717876962175],
#  [0.22740981776211006, 0.35613514742143165, 0.23742342683131878, 0.18357204433839805],
#  [0.2251977472253786, 0.35259929405348617, 0.23506619747054816, 0.1820968392014861],
#  [0.22398947256666168, 0.3506536389095832, 0.2337690921759216, 0.1812863238749413],
#  [0.22332472393122893, 0.34958588183040445, 0.23305725468274308, 0.18084122036521666],
#  [0.22295988662438507, 0.3489993648413856, 0.23266624318884835, 0.18059678604443768],
#  [0.22275948804523688, 0.34867729332896297, 0.23245152889759796, 0.18046254946546195]]

