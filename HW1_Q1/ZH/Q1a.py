import pprint

pp = pprint.PrettyPrinter()

G = [[1.0, 0.1, 0.3],
     [0.2, 1.0, 0.3],
     [0.2, 0.2, 1.0]]
r = [1.0, 1.5, 1.0]


# G = [[1.0, 0.1, 0.2,0.3],
#      [0.2, 1.0, 0.1, 0.1],
#      [0.2, 0.1, 1.0, 0.1],
#      [0.1, 0.1, 0.3, 1.0]]
# r = [2.0, 2.5, 1.5, 2.0]

n = 0.1

pi = [[1.0, 1.0, 1.0]]
SIRi = []


# Gji = send from i to j

def get_p():
    return pi[len(pi) - 1]


def get_SIR():
    return SIRi[len(SIRi) - 1]


def calc_SIR(i):
    p = get_p()
    sum = 0.0
    # print(sum)
    for j in range(len(G)):
        if i == j: continue
        sum += (G[i][j] * p[j])

    return (G[i][i] * p[i]) / (sum + n)


def update_SIRi():
    SIR = []
    for i in range(len(G)):
        SIR.append(calc_SIR(i))
    SIRi.append(SIR)

def update_pi():
    p_next = []
    p_old = get_p()
    SIR = get_SIR()
    for i in range(len(G)):
        p_next.append((r[i]/SIR[i])*p_old[i])
    pi.append(p_next)

update_SIRi()



for k in range(10):
    update_pi()
    update_SIRi()

print("SIR")
pp.pprint(SIRi)
print("p")
pp.pprint(pi)

# result
# SIR
# [[2.0, 1.6666666666666667, 2.0],
#  [1.4705882352941178, 2.571428571428571, 1.3157894736842106],
#  [1.275797373358349, 1.8617021276595747, 1.3919413919413917],
#  [1.1886708296164137, 1.7984693877551021, 1.1475409836065575],
#  [1.084926203726107, 1.6317469127237407, 1.1044568245125348],
#  [1.0487106162602164, 1.5747268754552075, 1.0446523402831327],
#  [1.0223143505798171, 1.5348922482538225, 1.024840043480141],
#  [1.0115538894441853, 1.517793568274324, 1.0113846772848454],
#  [1.005452628964246, 1.5084919617794983, 1.0058052445676842],
#  [1.0027111419860042, 1.5041913162264908, 1.002750939626297],
#  [1.001300329142734, 1.5020200371251984, 1.0013596860853502]]
# p
# [[1.0, 1.0, 1.0],
#  [0.5, 0.8999999999999999, 0.5],
#  [0.33999999999999997, 0.525, 0.37999999999999995],
#  [0.26649999999999996, 0.423, 0.273],
#  [0.2242, 0.3528, 0.2379],
#  [0.20665000000000003, 0.324315, 0.2154],
#  [0.1970515, 0.308925, 0.20619300000000004],
#  [0.1927504, 0.3019023, 0.20119530000000002],
#  [0.19054882, 0.298363005, 0.19893054],
#  [0.18951546250000004, 0.296683389, 0.19778236500000002],
#  [0.1890030484, 0.29585670300000005, 0.19723977030000003]]
